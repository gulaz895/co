local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local hum = char:WaitForChild("Humanoid")
local hrp = char:WaitForChild("HumanoidRootPart")

-- สร้าง GUI ปุ่ม
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")

local button = Instance.new("TextButton")
button.Size = UDim2.new(0, 150, 0, 50)
button.Position = UDim2.new(0.05, 0, 0.1, 0)
button.Text = "⚡ เปิดฟังก์ชัน"
button.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Parent = screenGui
button.Visible = true

-- ตัวแปร state
local enabled = false
local isFloating = false
local originalPosition = nil
local floatHeight = 30

-- ฟังก์ชันเปิด/ปิด
button.MouseButton1Click:Connect(function()
	enabled = not enabled
	if enabled then
		button.Text = "✅ เปิดฟังก์ชัน"
		button.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
	else
		button.Text = "⚡ เปิดฟังก์ชัน"
		button.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
		if isFloating and originalPosition then
			hrp.CFrame = originalPosition
			isFloating = false
		end
	end
end)

-- Heartbeat loop จำลอง state machine / logic ของ obfuscated
RunService.Heartbeat:Connect(function()
	if enabled then
		local hp = hum.Health
		
		-- State machine ตัวอย่าง (เหมือน e,W ในโค้ด obfuscated)
		if hp <= 10 then
			if not isFloating then
				originalPosition = hrp.CFrame
				isFloating = true
			end
			hrp.CFrame = CFrame.new(originalPosition.Position + Vector3.new(0,floatHeight,0))
		elseif hp >= 12 and isFloating and originalPosition then
			hrp.CFrame = originalPosition
			isFloating = false
		end

		-- ตัวอย่าง logic เพิ่มเติมจาก obfuscated
		-- เช่น แก้ไข table หรือเรียก function ของ object
		-- local t = {1,2,3}
		-- t[1] = t[1] + 1
		-- สามารถต่อยอดทำ automation / state update ได้
	end
end)
